---
- name: create sentinel config file
  template:
    src: sentinel.conf.j2
    dest: /etc/redis-sentinel.conf
    owner: redis
    mode: 0640
  notify: restart sentinel

# Flush handlers before ensuring the service is started to prevent
# a start and then restart
- name: flush handlers to apply config changes
  meta: flush_handlers

- name: ensure sentinel is running and enabled
  service:
    name: redis-sentinel
    state: started
    enabled: true
